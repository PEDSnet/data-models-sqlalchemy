machine:
  python:
    version: 2.7.3
  services:
    - docker

dependencies:
  post:
    - pip install awscli wheel twine
    - docker build -t
      dbhi/data-models-sqlalchemy:$(./version.sh | sed "s/+/-/") .

test:
  override:
    - docker run -d -p "5000:80"
      dbhi/data-models-sqlalchemy:$(./version.sh | sed "s/+/-/"); sleep 10
    - dmsa test http://localhost:5000

deployment:
  elasticbeanstalk:
    branch: master
    commands:
      - ./deploy.sh
